# Prueba de carga de archivos con TypeScript

Este script permite probar el endpoint `/upload` del microservicio Go Oracle API usando TypeScript y entornos como Bun, Deno o Node.js (v18+).

## test-upload.ts

```typescript
// test-upload.ts
// Prueba de carga de archivos al endpoint /upload usando fetch (compatible con Bun, Deno, Node.js v18+)

const url = 'http://localhost:8080/upload';
const token = 'TU_TOKEN_AQUI'; // Reemplaza por tu API_TOKEN si es necesario
const filePath = './archivo_prueba.txt'; // Cambia por el archivo que quieras subir
const descripcion = 'Archivo de prueba subido desde script TypeScript';

async function main() {
  // Leer archivo como binario
  const fileData = await Bun.file(filePath).arrayBuffer(); // Para Bun
  // Para Deno: const fileData = await Deno.readFile(filePath);
  // Para Node.js: const fileData = await import('fs').then(fs => fs.promises.readFile(filePath));

  // Crear FormData
  const form = new FormData();
  form.append('file', new Blob([fileData]), filePath.split('/').pop());
  form.append('descripcion', descripcion);

  const res = await fetch(url, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`
    },
    body: form
  });
  const data = await res.json();
  console.log('Respuesta:', data);
}

main().catch(console.error);
```

### Uso

1. Modifica `token` y `filePath` según tu entorno.
2. Elige la línea de lectura de archivo según tu entorno (Bun, Deno o Node.js).
3. Ejecuta el script con tu entorno preferido.

- **Bun:**
  ```sh
  bun run test-upload.ts
  ```
- **Deno:**
  ```sh
  deno run --allow-read --allow-net test-upload.ts
  ```
- **Node.js (v18+):**
  Instala `node-fetch` y usa la línea de Node.js para leer el archivo.

### Notas
- El endpoint `/upload` espera un archivo y un campo opcional `descripcion`.
- El archivo se almacena en la tabla Oracle `archivos` (debes crearla si no existe):
  ```sql
  CREATE TABLE archivos (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(255),
    descripcion VARCHAR2(4000),
    contenido BLOB
  );
  ```
